<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<title>PRUEBAS CON XML ver 3</title>
		<script src="js/jquery3/jquery-3.0.0.min.js"></script>
		<script type="text/javascript">
		'use strict';
		(function(){
			function leedatos(version,arch){
				var datos=[];
				if (version == 3.3){
					alert(version);
				}else{
					alert("sin version");
				}
			}
			
			function getver(xmlDoc){
				var version
				var nodes = xmlDoc.childNodes
	            var comprobante = nodes[0]
				var comprob = xmlDoc.getElementsByTagName('cfdi:Comprobante');
				version = comprobante.getAttribute('Version');
				
				if(!version)
				{
					version = "3.2"
				}
				
				return version
			}
			
			function leexml(arch){
				var xmlDoc = $.parseXML(arch);
				var version = getver(xmlDoc);
				leedatos(version,xmlDoc);
			}
			
			
			function leetodos(files){
				var resul = [];
				for (var i=0, f; f=files[i]; i++) {
			          var r = new FileReader();
		            r.onload = (function(f) {
		                return function(e) {
		                    var resul = e.target.result;
							leexml(resul);
		                };
		            })(f);
		            r.readAsText(f);
		        } 

			}

			function listaarch(e){
				var files = e.target.files; // FileList object
				leetodos(files);
			}
			$(document).ready(function(){
				var evt = document.getElementById('files');
				evt.addEventListener('change', function(e){listaarch(e)},false);
			});

		})();
		</script>
	</head>
	<body>
		<h2>PRUEBAS CON ARCHIVOS XML</h2>
		<div align="center">
			<form>
				<div>
					<label for="files">Seleccione las facturas</label>
				</div>
				<div>
					<input id="files" name="files[]" type="file" accept=".xml" multiple/>
				</div>
	
			</form>
		</div>
		<div id="list">
		<table id="lista">
		<tr><th>RAZON SOCIAL</th><th>RFC</th></tr>
		</table>
		</div>
	</body>
</html>